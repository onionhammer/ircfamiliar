function ajax(b,a,e,c){"undefined"===typeof c&&(c="POST");var d=new XMLHttpRequest;d.onreadystatechange=function(a){4===d.readyState&&e({code:d.status,data:d.responseText})};d.open(c,b,!0);d.send(a)}function detectLinks(b){b.innerHTML=b.innerHTML.replace(/(\bhttps?:\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,function(a){return'<a href="'+a+'" target="_blank">'+a+"</a>"});return b}function $(b){return document.querySelectorAll(b)}function _new(b){return document.createElement(b)}var _dom;
(function(b){function a(b,c,d){for(var f=0,g=c.length;f<g;++f)if(c[f]===d)return d;d=d.parentElement;return d===b?null:null!==d?a(b,c,d):null}Object.prototype.bind=function(a,b){if(void 0!==this.length)for(var d=0,f=this.length;d<f;++d)this[d].addEventListener(a,function(a){a.eventTarget=this;b.call(this,a)});else this.addEventListener(a,function(a){a.eventTarget=this;b.call(this,a)});return this};Object.prototype.on=function(b,c,d){for(var f=0,g=this.length;f<g;++f){var h=this[f];h.addEventListener(c,
function(c){var f=a(h,$(b),c.srcElement);null!==f&&(c.eventTarget=f,d.call(f,c))})}};Object.prototype.attr=function(a,b){if(void 0===this.length){if(void 0===b)return this.getAttribute(a);null===b?this.removeAttribute(a):this.setAttribute(a,b)}else for(var d=0,f=this.length;d<f;++d){if(void 0===b)return this[d].getAttribute(a);null===b?this[d].removeAttribute(a):this[d].setAttribute(a,b)}return this};Object.prototype.css=function(){for(var a=[],b=0;b<arguments.length-0;b++)a[b]=arguments[b+0];for(var b=
0,d=this.length;b<d;++b){var f=this[b];if(1<a.length)f.style[a[0]]=a[1];else{if("string"===typeof a[0])return f.style[a[0]];for(var g in a[0])f.style[g]=a[0][g]}}return this};Object.prototype.removeClass=function(a){for(var b=0,d=this.length;b<d;++b)this[b].classList.remove(a);return this};Object.prototype.addClass=function(a){for(var b=0,d=this.length;b<d;++b)this[b].classList.add(a);return this};Object.prototype.insertAfter=function(a){if(void 0!==this.length)for(var b=0,d=this.length;b<d;++b)a.parentElement.insertBefore(this[b],
a.nextSibling);else a.parentElement.insertBefore(this,a.nextSibling)};Object.prototype.append=function(a){if(void 0!==a.length)for(var b=0,d=a.length;b<d;++b)this.appendChild(a[b]);else this.appendChild(a);return this};Object.prototype.prepend=function(a){if(void 0!==a.item)for(;a.length;)this.insertBefore(a[0],this.firstChild);else if(void 0!==a.length)for(var b=0,d=a.length;b<d;++b)this.insertBefore(a[b],this.firstChild);else this.insertBefore(a,this.firstChild);return this};Object.prototype.remove=
function(){if(void 0!==this.length)for(var a=0,b=this.length;a<b;++a)this[a].parentNode.removeChild(this[a]);else this.parentNode.removeChild(this)};Object.prototype.nodeText=function(a){if(void 0===a)return this.innerText;this.innerText=a;return this};Object.prototype.empty=function(){if(void 0!==this.length)for(var a=0,b=this.length;a<b;++a)this[a].innerHTML="";else this.innerHTML="";return this}})(_dom||(_dom={}));
var logview=function(){function b(){}b.appendMessage=function(a,e,c,d){var f=1===d.charCodeAt(0)&&0===d.substr(1).indexOf("ACTION"),g=b.findChannel(a,e)[0];f&&(d=c+d.substr(7),c=null);if(null==g)console.error("Could not find channel",arguments);else{var h=RegExp(settings.nick,"i").test(d),k=null;f?k="action":h&&(k="mention");b.appendLog(g,c,d,k)&&(f=h?"alert":"new",channelview.findChannelMenu(a,e).classList.add(f));channelview.checkInactive(g,a,h,c,d)}};b.appendAll=function(a,e,c){for(var d=$(".channel-display"),
f=0,g=d.length;f<g;++f)b.appendLog(d[f],a,e,c)};b.appendLog=function(a,e,c,d){var f=a.getElementsByClassName("logview")[0],g=!1,h=new Date,h=_new("li").attr("data-timestamp",h.toJSON()).attr("title",b.formatDate(h));null!=e&&h.append(_new("a").attr("class","user").nodeText(e));if(null!=d)for(e=d.split(" "),d=0;d<e.length;++d)h.classList.add(e[d]);else b.updateJoinPartVisibility(f);h.append(detectLinks(_new("div").attr("class","message").nodeText(c)));a.classList.contains("active")?(a=b.nearBottom(f),
f.append(h),channelview.is_mobile&&b.pruneLog(f),a?b.scrollToBottom(f):g=!0):(f.append(h),g=!0,channelview.is_mobile&&b.pruneLog(f));return g};b.switchChannel=function(a,e,c){"undefined"===typeof c&&(c=!1);var d=b.findActiveChannel(),f=$("#channels li a");e=b.findChannel(a,e);if(0!==e.length){d.removeClass("active");e.addClass("active");b.becomeActive(d[0]);b.becomeInactive(new Date,d[0]);b.becomeActive(e[0]);b.scrollToBottom();for(var d=0,g=f.length;d<g;++d){var h=f[d];h.innerText===a?h.classList.add("active"):
h.classList.remove("active")}!1===c&&(window.location.hash=a);channelview.evaluateActive(e[0]);return e[0]}};b.restoreChannel=function(a){if(""==a)return null;b.switchChannel(a,null,!0)};b.becomeActive=function(a){a=null!=a?[a]:b.findActiveChannel();a=channelview.findChannelMenu(a.attr("data-channel"),a.attr("data-server"));a.classList.remove("new");a.classList.remove("alert");$("link[rel=icon]")[0].href="/favicon.ico"};b.becomeInactive=function(a,b){var c;c=null!=b?[b]:$(".channel-display");for(var d=
0,f=c.length;d<f;++d){b=c[d];for(var g=b.getElementsByClassName("logview")[0].getElementsByTagName("li"),h,k=0,m=g.length;k<m;++k){var l=g[k].attr("data-timestamp");if(new Date(l)<a)h=g[k],h.classList.remove("last-read");else break}null!=h&&h.classList.add("last-read")}};b.updateJoinPartVisibility=function(a){a=a.querySelectorAll(".join.show, .part.show");for(var b=0,c=a.length;b<c;++b)a[b].classList.remove("show")};b.pruneLog=function(a){for(var e=a.children.length;e>b.MAX_MOBILE_LOG;)a.removeChild(a.children[0]),
--e};b.removeAfter=function(a,b){setTimeout(function(){a.remove()},1E3*b)};b.nearBottom=function(a){return 150>a.scrollHeight-(a.scrollTop+a.clientHeight)};b.scrollToBottom=function(a){void 0===a&&(a=b.findActiveChannel(".logview")[0]);a&&(a.scrollTop=a.scrollHeight)};b.findChannels=function(a,b){"undefined"===typeof b&&(b=null);var c=".channel-display";null!=a&&(c+="[data-server='"+a+"']");b&&(c+=" "+b);return $(c)};b.findChannel=function(a,b,c){"undefined"===typeof b&&(b=null);"undefined"===typeof c&&
(c=null);a=".channel-display[data-channel='"+a.toLowerCase()+"']";null!=b&&(a+="[data-server='"+b+"']");c&&(a+=" "+c);return $(a)};b.findActiveChannel=function(a){"undefined"===typeof a&&(a=null);return a?$(".channel-display.active "+a):$(".channel-display.active")};b.formatDate=function(a){return a.toLocaleTimeString()+" on "+a.toLocaleDateString()};b.MAX_MOBILE_LOG=100;return b}(),messagehistory=function(){function b(a){"undefined"===typeof a&&(a=100);this.maxLength=a;this.items=[]}b.prototype.add=
function(a){this.items.push(a);this.items.length>this.maxLength&&this.items.shift();return this.reset()};b.prototype.up=function(){0==this.index&&(this.index=1);return this.items[--this.index]};b.prototype.down=function(){if(this.index!=this.items.length)return this.items[++this.index]};b.prototype.reset=function(){this.index=this.items.length;return this};return b}(),timer=function(){function b(){}b.initialize=function(a,e,c){b.inactiveLimit=1E3*a;b.onUserIdle=e;b.onUserActive=c;document.body.bind("mousemove",
b.userNowActive).bind("keypress",b.userNowActive);setInterval(function(){b.idleTime+=1E4;b.idleTime>=b.inactiveLimit&&!0===b.isUserActive&&(b.isUserActive=!1,b.onUserIdle(b.lastMove))},1E4)};b.userNowActive=function(){!1===b.isUserActive&&(b.isUserActive=!0,b.onUserActive());b.lastMove=new Date;b.idleTime=0};b.lastMove=new Date;b.idleTime=0;b.isUserActive=!0;return b}(),channelview=function(){function b(){}b.initialize=function(){b.supports_touch="ontouchstart"in window;b.is_mobile=document.getElementById("content").classList.contains("mobile");
logview.restoreChannel(window.location.hash);!1!==b.focusChat(!1)&&(logview.scrollToBottom(),$("#channels").on("li a","click",function(a){return b.onChangeChannel(a)}),$("#chatbox").bind("keypress",function(a){return b.onReturn(a)}).bind("keydown",function(a){return b.onChatBoxKey(a)}),$("#content").on("li a.user","dblclick",function(a){return b.onUserClicked(a)}),document.body.bind("keydown",function(a){return b.onArrows(a)}),window.addEventListener("resize",function(a){return b.onWindowResized(a)}),
window.addEventListener("popstate",function(a){return b.onHistoryChanged(a)}),timer.initialize(b.IDLE_TIME,logview.becomeInactive,logview.becomeActive),b.history=new messagehistory)};b.setMessageCallback=function(a){b.sendMessage=a};b.onChangeChannel=function(a){var b=a.eventTarget;a=b.innerText;b=b.attr("data-server");logview.switchChannel(a,b)};b.onReturn=function(a){if(13===a.keyCode){var e=a.eventTarget.value,c=logview.findActiveChannel()[0];if(""!==e&&c){var d=c.attr("data-channel"),c=c.attr("data-server");
b.sendMessage(e,c,d);a.eventTarget.value="";b.history.add(e)}}};b.onArrows=function(a){var b=0,c=!1,d=document.getElementById("chatbox");switch(a.keyCode){case 37:b=-1;break;case 39:b=1;break;default:c=!0}if(0===b)c&&document.activeElement!==d&&d.focus();else if(c=""!==d.value,!1!==a.ctrlKey&&!0!==c)for(a=$("#channels li"),c=c=0,d=a.length;c<d;++c)if(a[c].getElementsByTagName("a")[0].classList.contains("active")){c+=b;0<=c&&c<=a.length-1&&(a=a[c].getElementsByTagName("a")[0],b=a.nodeText().trim(),
a=a.attr("data-server"),logview.switchChannel(b,a),$("#chatbox")[0].focus());break}};b.onChatBoxKey=function(a){switch(a.keyCode){case 38:var e=b.history.up();e&&(a.eventTarget.value=e);a.preventDefault();break;case 40:a.eventTarget.value=b.history.down()||"",a.preventDefault()}};b.onUserClicked=function(a){var b=a.eventTarget.innerText,c=document.getElementById("chatbox");0!==c.value.length&&(c.value+=" ");c.value+=b+" ";c.focus();a.preventDefault()};b.onWindowResized=function(a){a=logview.findActiveChannel(".logview")[0];
null!=a&&logview.scrollToBottom(a)};b.onHistoryChanged=function(a){if(b.popped||b.popped++){a=window.location.hash;if(""===a){var e=$("#channels li a")[0];null!=e&&(a=e.innerText.trim())}logview.restoreChannel(a)}};b.evaluateActive=function(a){var e=$("#chatbox")[0];0!==a.getElementsByClassName("userlist")[0].getElementsByTagName("li").length?(b.toggleConnected(!0),(!1===b.supports_touch||b.guessKeyboardUp())&&e.focus()):b.toggleConnected(!1)};b.joinChannel=function(a,b){var c=logview.findChannel(a,
b)[0];a=a.toLowerCase();if(null==c&&"#"===a[0])return c=_new("div").attr("class","channel-display").attr("data-channel",a).attr("data-server",b).append(_new("ul").attr("class","logview")).append(_new("ul").attr("class","userlist")),$("#content")[0].prepend(c),$("#channels")[0].append(_new("li").append(_new("a").attr("data-server",b).nodeText(a))),logview.switchChannel(a,b),c};b.leaveChannel=function(a,e){var c=logview.findChannel(a,e)[0];if(null!=c&&"#"===a[0]){if(c.classList.contains("active"))for(var d=
c.parentElement.childNodes,f=0,g=d.length;f<g;++f){var h=d[f];if(1===h.nodeType&&h.classList.contains("channel-display")&&!1===h.classList.contains("active")){logview.switchChannel(h.attr("data-channel"),h.attr("data-server"));break}}c.remove();b.findChannelMenu(a,e).parentElement.remove()}};b.updateUserNick=function(a,e,c){var d=logview.findChannels(a,".userlist li");a=logview.findChannels(a);for(var f=0,g=d.length;f<g;++f){var h=d[f];h.nodeText().trim()===e&&h.empty().append(b.makeUserLI(c))}settings.nick===
e?(e="Nickname changed to "+c,settings.nick=c):e=e+" is now known as "+c;f=0;for(g=a.length;f<g;++f)logview.appendLog(a[f],null,e,"join show")};b.quitUser=function(a,e){for(var c=logview.findChannels(a),d=0,f=c.length;d<f;++d)b.removeUser(null,a,e,c[d],!0)};b.removeUser=function(a,e,c,d,f){"undefined"===typeof d&&(d=null);"undefined"===typeof f&&(f=!1);if(c===settings.nick)b.leaveChannel(a,e);else{null==d&&(d=logview.findChannel(a,e)[0]);a=d.getElementsByClassName("userlist")[0].getElementsByTagName("li");
e=0;for(var g=a.length;e<g;++e){var h=a[e];if(h.nodeText().trim()===c){h.remove();logview.appendLog(d,null,c+" has "+(f?"quit":"left"),"part show");break}}}};b.updateUsers=function(a,e,c){a=logview.findChannel(a,e)[0];e=a.getElementsByClassName("userlist")[0];e.empty();c.sort(b.sortStrings);for(var d=0,f=c.length;d<f;++d)e.append(b.makeUserLI(c[d]));a.classList.contains("active")&&b.toggleConnected(0!==c.length)};b.addUser=function(a,e,c){var d=logview.findChannel(a,e)[0];null==d&&(d=b.joinChannel(a,
e));a=d.getElementsByClassName("userlist")[0];e=a.getElementsByTagName("li");for(var f=b.makeUserLI(c),g=!1,h=c.toLowerCase(),k=0,m=e.length;k<m;++k){var l=e[k].nodeText().trim().toLowerCase();if(h===l)return;if(h<l){a.insertBefore(f,e[k]);g=!0;break}}!1===g&&a.append(f);settings.nick===c?(b.focusChat(!0),logview.appendLog(d,null,"Connected","join show"),c=$(".logview .motd"),logview.removeAfter(c,2)):logview.appendLog(d,null,c+" has joined","join show")};b.setWebsocketConnected=function(a){var e=
b.websocket_connected;b.websocket_connected=a;!0==e&&!1==a?($(".userlist").empty(),b.toggleConnected(!1)):!0==a&&(a=logview.findActiveChannel(),0!==a.length&&b.evaluateActive(a[0]))};b.toggleConnected=function(a){a=a&&b.websocket_connected;$("#chatbox").attr("disabled",a?null:"disabled")};b.swapChannelView=function(a){var e=document.createElement("body"),c=$("#content")[0],d=logview.findActiveChannel()[0],f,g;d&&(f=d.attr("data-channel"),g=d.attr("data-server"));e.innerHTML=a;a=e.getElementsByTagName("script")[0];
settings=JSON.parse(a.nodeText());a.remove();$(".channel-display").remove();c.prepend(e.children);f&&g&&logview.switchChannel(f,g,!0);0<$(".channel-display.active .userlist li").length&&b.toggleConnected(!0);b.rebuildMenu();delete e};b.rebuildMenu=function(){var a=$("#channels")[0];if(null!=a){a.empty();for(var b=logview.findChannels(null),c=0,d=b.length;c<d;++c){var f=b[c],g=f.attr("data-channel"),h=f.attr("data-server"),f=f.classList.contains("active"),g=_new("a").attr("data-server",h).nodeText(g);
f&&g.attr("class","active");a.prepend(_new("li").append(g))}}};b.checkInactive=function(a,e,c,d,f){if(c&&!1===timer.isUserActive&&($("link[rel=icon]")[0].href="/favicon_on.ico",b.show_notifications)){var g=window.webkitNotifications.createNotification("/favicon_on.png",(d?d+" on ":"")+e,f);g.onclick=function(){window.focus();logview.switchChannel(e,a.attr("data-server"),!0);g.cancel()};g.show();setTimeout(function(){return g.cancel()},5E3)}};b.makeUserLI=function(a){var b=!1;switch(a[0]){case "~":case "&":case "@":case "%":case "+":a=
a.substr(1),b=!0}return _new("li").append(_new("a").attr("class","user"+(b?" mod":"")).nodeText(a))};b.findChannelMenu=function(a,b){for(var c=$("#channels a[data-server='"+b+"']"),d=0,f=c.length;d<f;++d)if(c[d].innerText===a.toLowerCase())return c[d];throw"Channel not found";};b.focusChat=function(a){var e=$("#chatbox")[0];return null!=e?(e.focus(),a&&b.toggleConnected(!0),!0):!1};b.guessKeyboardUp=function(){return window.innerHeight<window.innerWidth};b.sortStrings=function(a,b){var c=a.toLowerCase(),
d=b.toLowerCase();return c<d?-1:c>d?1:0};b.IDLE_TIME=30;b.popped=0;b.supports_touch=!1;b.is_mobile=!1;b.show_notifications=!1;b.websocket_connected=!1;return b}(),eventrelay=function(){function b(){}b.MPrivMsg=function(a){logview.appendMessage(a.origin,a.servername,a.nick,a.params[1])};b.MTopic=function(a){var b=logview.findChannel(a.origin,a.servername)[0];logview.appendLog(b,null,a.nick+" changed the topic to: "+a.params[1],"topic")};b.MJoin=function(a){channelview.addUser(a.origin,a.servername,
a.nick)};b.MPart=function(a){channelview.removeUser(a.origin,a.servername,a.nick)};b.MQuit=function(a){channelview.quitUser(a.servername,a.nick)};b.MNick=function(a){channelview.updateUserNick(a.servername,a.nick,a.origin)};b.MOTD=function(a){for(var b=logview.findChannels(a.servername),c=0,d=b.length;c<d;++c){var f=b[c];a.params&&a.params[1]&&logview.appendLog(f,null,a.params[1],"motd")}};b.NAMES=function(a){for(var b,c=0,d=a.params.length;c<d;++c){var f=a.params[c];if(0===f.indexOf("#"))b=f;else if(b){channelview.updateUsers(b,
a.servername,f.split(" "));break}}};b.SUBSCRIBED=function(a){channelview.swapChannelView(a.data);logview.appendAll(null,"Client reconnected","part");logview.scrollToBottom()};return b}(),MessageKind=function(){function b(){}b.subscribed="Subscribed";return b}(),service=function(){function b(){}b.initialize=function(){var a="ws://"+window.location.hostname+":"+settings.servicePort;b.reconnecting?console.log("Attempting reconnect..."):b.reconnect=b.throttle(b.initialize,b.TRY_WAIT);a=new WebSocket(a);
a.onopen=b.onOpened;a.onmessage=b.onMessage;a.onclose=b.onClose;a.onerror=b.onError;b.ws=a;channelview.setMessageCallback(b.onLocalMessageSent)};b.onLocalMessageSent=function(a,e,c){"undefined"===typeof c&&(c="");b.sendMessage({message:a,server:e,target:c})};b.sendMessage=function(a){a=JSON.stringify(a);b.ws.send(a)};b.onMessage=function(a){a=JSON.parse(a.data);switch(a.cmd){case "MPrivMsg":case "MJoin":case "MTopic":case "MPart":case "MQuit":case "MNick":eventrelay[a.cmd](a);break;case "MNumeric":switch(a.numeric|
0){case 372:eventrelay.MOTD(a);break;case 353:eventrelay.NAMES(a)}}};b.onOpened=function(a){b.reconnecting&&(ajax("/state",null,eventrelay.SUBSCRIBED),b.reconnecting=!1);console.log("Websocket connected.");channelview.setWebsocketConnected(!0)};b.onClose=function(a){!1===b.reconnecting&&(console.log("Websocket disconnected."),logview.appendAll(null,"Client disconnected","part"));b.reconnect();b.reconnecting=!0;channelview.setWebsocketConnected(!1)};b.onError=function(a){};b.throttle=function(a,b,
c){var d,f,g;return function(){f=arguments;g=!0;c=c||this;d||function(){g?(a.apply(c,f),g=!1,d=setTimeout(arguments.callee,b)):d=null}()}};b.TRY_WAIT=3E4;b.reconnecting=!1;return b}(),touch=function(){function b(){}b.initialize=function(){b.content=$("#content.mobile")[0];if(b.content){var a=$("body");a.on("#content:not(.shut) .userlist","touchstart",b.onTouchStart);a.on("#content:not(.shut) .userlist","touchmove",b.onTouchMove);a.on("#content:not(.shut) .userlist","touchend",function(a){return b.onTouchEnd(a,
!1)});a.on("#content.shut .logview","touchstart",b.onTouchStart);a.on("#content.shut .logview","touchmove",b.onTouchMove);a.on("#content.shut .logview","touchend",function(a){return b.onTouchEnd(a,!0)})}};b.onTouchStart=function(a){b.startX=a.touches[0].clientX;b.startY=a.touches[0].clientY;b.moved=!1};b.onTouchMove=function(a){var e=b.activeList(),c=b.startX-a.touches[0].clientX,d=Math.abs(c),f=Math.abs(b.startY-a.touches[0].clientY),f=d>f&&d+f>b.MIN_MOVE;b.moved=f&&d>b.MIN_SNAP;e&&f?(!1==b.opened&&
(c-=e.clientWidth),0<c&&(c=0),b.content.classList.add("slide"),e.style.marginRight=c+"px",a.preventDefault()):e.style.marginRight=null};b.onTouchEnd=function(a,e){b.activeList().style.marginRight=null;b.content.classList.remove("slide");b.moved&&(e?b.content.classList.remove("shut"):b.content.classList.add("shut"),b.opened=e,logview.scrollToBottom())};b.activeList=function(){return $(".active .userlist")[0]};b.MIN_MOVE=5;b.MIN_SNAP=15;b.opened=!0;b.moved=!1;b.startX=0;b.startY=0;return b}(),menu=
function(){function b(){}b.initialize=function(){$("#settings").bind("click",function(a){return b.onSettingsToggled(a)});"webkitNotifications"in window&&b.initializeNotifications();b.initializeTheme();b.initializeShowStatus()};b.onSettingsToggled=function(a){b.visible=!b.visible;a=b.visible;var e=$("#settings")[0],c=$("header a.menu-item");a?e.classList.add("on"):e.classList.remove("on");for(var e=0,d=c.length;e<d;++e){var f=c[e];f.classList.contains("disabled")?f.attr("style","display: none"):f.attr("style",
"display: "+(a?"inline":"none"))}};b.onNotificationToggled=function(a){a=a.eventTarget;!0===channelview.show_notifications?(channelview.show_notifications=!1,a.nodeText("show notifications"),a.classList.remove("on"),localStorage["show-notifications"]=!1):(window.webkitNotifications.requestPermission(function(){}),channelview.show_notifications=0===window.webkitNotifications.checkPermission(),!0===channelview.show_notifications&&(a.nodeText("hide notifications"),a.classList.add("on"),localStorage["show-notifications"]=
!0))};b.onThemeToggled=function(a){a=a.eventTarget;var b=a.classList.contains("on");b?(document.body.classList.remove("dark"),a.classList.remove("on"),a.nodeText("night mode")):(document.body.classList.add("dark"),a.classList.add("on"),a.nodeText("day mode"));localStorage["night-mode"]=!b};b.onShowStatusToggled=function(a){a=a.eventTarget;var b=a.classList.contains("on");b?(document.body.classList.remove("hide-statuses"),a.classList.remove("on"),a.nodeText("hide joins/parts")):(document.body.classList.add("hide-statuses"),
a.classList.add("on"),a.nodeText("show joins/parts"));localStorage["hide-statuses"]=!b};b.initializeNotifications=function(){channelview.show_notifications=0===window.webkitNotifications.checkPermission()&&"true"===(localStorage["show-notifications"]||"true");var a=$("#notifications")[0];a.classList.remove("disabled");!0===channelview.show_notifications&&(a.nodeText("hide notifications"),a.classList.add("on"));a.bind("click",function(a){return b.onNotificationToggled(a)})};b.initializeTheme=function(){var a=
$("#theme")[0];a.bind("click",function(a){return b.onThemeToggled(a)});if("true"==localStorage["night-mode"])b.onThemeToggled({eventTarget:a})};b.initializeShowStatus=function(){var a=$("#toggle-statuses")[0];a.bind("click",function(a){return b.onShowStatusToggled(a)});if("true"==localStorage["hide-statuses"])b.onShowStatusToggled({eventTarget:a})};b.visible=!1;return b}();
function onLoad(){channelview.initialize();touch.initialize();service.initialize();menu.initialize();window.removeEventListener("load",onLoad,!1)}window.addEventListener("load",onLoad,!1);
